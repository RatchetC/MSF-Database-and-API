/**
 * IIFE (pronounced "iffy")
 * Immediately-Invoked Function Expression
 * (function () {
 *   
 *   'use strict';        <- Indicates that the code should be executed in strict mode.
 * 
 * })();
 */
(function () {

  'use strict';

  var app = angular.module('promises-test', [
    'ionic', // include the ionic library as a dependency (already in the app.js angular module declaration by default)
    'restlet.sdk', // include the module generated by the restlet API to get access to 'activityevents' which is the service that is in the restlet.sdk module. The 'activityevents' service contains methods that can be used to send requests to the API
    'eventsjs' // module which contains the config file and controller files to do with 'events' in the app as well as the 'event' service used by them and controllers for other parts of the app such as activities that might use it.
  ]);

  // app.run is kind of like public static void main(String[] args) {} in Java
  // by default it only has $ionicPlatform. $rootScope and activityevents were included for reasons mentioned below
  app.run(function ($ionicPlatform, $rootScope, activityevents) {
    $ionicPlatform.ready(function () {
      if (window.cordova && window.cordova.plugins.Keyboard) {
        cordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);
        cordova.plugins.Keyboard.disableScroll(true);
      }
      if (window.StatusBar) {
        StatusBar.styleDefault();
      }
    });

    // setting event listeners for $stateChangeStart and $stateChangeSuccess.
    $rootScope.$on('$stateChangeStart', function (e, toState, toParams, fromState, fromParams, options) {
      // log the event and which state the app is moving to as well as which state the app is moving to
      console.log('$stateChangeStart fired');
      console.log('Moving from ' + fromState.url + ' to ' + toState.url);
    });

    $rootScope.$on('$stateChangeSuccess', function (e, toState, toParams, fromState, fromParams) {
      console.log('$stateChangeSuccess fired');
      console.log('Moved to ' + toState.url + ' from ' + fromState.url);
    });

    // this function configures the authentication for all the HTTP requests that the app makes to the API.
    /**
     * @param username This is the username (first parameter)
     * @param password This is the surprise suprise password (second parameter)
     * If you don't want to keep coming back to this file then you can find both of them by going to the dashboard on restlet cloud and going to the API page. They are under endpoint.
     */
    activityevents.configureHTTP_BASICAuthentication('a4ccb4f9-f183-4505-b178-cca604d6c678', '4e39077a-383c-407c-a538-dd2c7cda3dfc');
  });

})();
